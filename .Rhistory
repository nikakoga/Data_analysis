main="Zależność pomiędzy ilością chorych od czasu",
xlab="Data",
ylab="Całkowita liczba przypadków",
names.arg=as.Date(dane_sel$date),
las=2,
cex.names=0.8,
col="pink",
border = "lightblue"
)
barplot(dane_sel$total_cases,
main="Zależność pomiędzy ilością chorych od czasu",
xlab="Data",
ylab="Całkowita liczba przypadków",
names.arg=as.Date(dane_sel$date),
las=2,
cex.names=0.8,
col="pink",
border = "black"
)
my_text<-"Hello"
cat(my_text, sep="  \n", file = "my_text.Rmd")
render("my_text.Rmd", pdf_document())
require(rmarkdown)
my_text<-"Hello"
cat(my_text, sep="  \n", file = "my_text.Rmd")
render("my_text.Rmd", pdf_document())
file.remove("my_text.Rmd") #cleanup
setwd("C:/Users/weron/Documents/Studia/PP/4 semestr/SAD/Projekt")
library("Hmisc")
library("rmarkdown")
require(rmarkdown)
my_text<-"Hello"
cat(my_text, sep="  \n", file = "my_text.Rmd")
render("my_text.Rmd", pdf_document())
file.remove("my_text.Rmd") #cleanup
install.packages("knitr")
install.packages("knitr")
require(knitr)
my_text <- "Hello"
cat(my_text, sep="  \n", file = "my_text.Rmd")
knit2pdf("my_text.Rmd")
file.remove("my_text.Rmd")
require(knitr)
my_text <- "Hello"
cat(my_text, sep="  \n", file = "my_text.Rmd")
knit2pdf("my_text.Rmd")
file.remove("my_text.Rmd")
require(knitr)
my_text <- "Hello"
knit(text = my_text, output = "my_text.pdf")
require(knitr)
my_text <- "Hello pls start working"
knit(text = my_text, output = "my_text.pdf")
require(knitr)
my_text <- "Hello pls start working"
knit(text = my_text, output = "my_text.pdf")
require(knitr)
source("~/Studia/PP/4 semestr/SAD/Projekt/Data_analysis.R")
require(knitr)
my_text <- "Hello pls start working"
knit(text = my_text, output = "my_text.pdf")
require(knitr)
my_text <- "Hello pls start working"
knit(text = my_text, output = "my_text.pdf")
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
require(knitr)
my_text <- "Hello pls start working"
knit(text = my_text, output = "my_text.pdf")
require(knitr)
my_text <- "Hello pls start working"
knit(text = my_text, output = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.pdf")
library(pdftools)
install.packages("pdftools")
library(pdftools)
my_pdf<-"C:/Users/weron/Documents/Studia/PP/4_semestr/SAD/Projekt/TEST.pdf"
my_pdf<-"C:/Users/weron/Documents/Studia/PP/4_semestr/SAD/Projekt/TEST.pdf"
my_picture<-"C:/Users/weron/Documents/Studia/PP/4_semestr/SAD/Projekt/OBRAZ.jpg"
# konwertujemy plik PDF na obiekt R
pdf <- pdf_convert(my_pdf)
# wstawiamy obraz
pdf <- pdf_insert_image(pdf, "OBRAZ.jpg", page = n_pages(pdf)+1)
library(pdftools)
my_pdf<-"C:/Users/weron/Documents/Studia/PP/4_semestr/SAD/Projekt/TEST.pdf"
my_picture<-"C:/Users/weron/Documents/Studia/PP/4_semestr/SAD/Projekt/OBRAZ.jpg"
# konwertujemy plik PDF na obiekt R
pdf <- pdf_convert(my_pdf)
# wstawiamy obraz
pdf <- pdf_insert_image(pdf, "OBRAZ.jpg", page = n_pages(pdf)+1)
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data<-Remove_NA(data_with_NA)
Descriptive_statistics(data)
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data<-Remove_NA(data_with_NA)
Descriptive_statistics(data)
require(knitr)
my_text <- "Hello pls start working"
knit(text = my_text, output = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.pdf")
dev.off()
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data<-Remove_NA(data_with_NA)
Descriptive_statistics(data)
dev.off()
Outliers_detection<-function(df)
{
write("\n\nOUTLIERS\n","raport.txt",append=TRUE)
for(col in names(df))
{
#TESTY
pdf(file= "TEST.pdf" )
if(is.numeric(df[[col]]))
{
boxplot(df[[col]],
ylab = col)
#outliners<-append(outliners,(paste(col,boxplot.stats(df[[col]])$out,"\n")))
outliers<-boxplot.stats(df[[col]])$out
if(length(outliers)>0)
{
capture.output(cat(col,outliers,"\n"), file = "raport.txt",append=TRUE)
}
else
{
capture.output(cat(col,"no outliners","\n"), file = "raport.txt",append=TRUE)
}
}
}
dev.off()
}
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data<-Remove_NA(data_with_NA)
Descriptive_statistics(data)
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
setwd("C:/Users/weron/Documents/Studia/PP/4_semestr/SAD/Projekt")
library("Hmisc")
Replace_blank_with_NA<-function(x)
{
x<-replace(x,x=='',NA)
return(x)
}
Remove_NA <- function(df){
change_report <- c()
df<-Replace_blank_with_NA(df)
for (col in names(df)) {
#If NA in numeric column than replace with a median
if(is.numeric(df[[col]]) & any(is.na(df[[col]]))) {
NA_rows <- which(is.na(df[[col]]))  # get rows with missing values
df[[col]][is.na(df[[col]])] <- median(df[[col]], na.rm = TRUE)
change_report <- c(change_report, paste("Missing data in column", col, "in rows:", paste(NA_rows, collapse = ", "),"replacing with a median",median(df[[col]])))
}
}
#Now every NA in numeric columns are gone
#I delete every row with NA in non numeric column
TRUE_FALSE_vector<-complete.cases(df) #returns FALSE for rows with NA
Rows_to_delete<-which(TRUE_FALSE_vector==FALSE)
ready<-df[complete.cases(df),]
if (length(Rows_to_delete) > 0) {
deleted <- paste("Lack of data in non-numeric column I removed rows index:", paste(Rows_to_delete, collapse = ", "))
change_report<-append(change_report,deleted)
}
if(length(change_report) > 0) {
writeLines(change_report, "raport.txt")
}
return(ready)
}
count_groups <- function(column) {
unique_elements <- unique(column)
num_unique <- length(unique_elements)
counts <- table(column)
df <- data.frame(ID = names(counts), count = as.numeric(counts))
df
write("\nGROPUS AND THEIR SIZE\n","raport.txt",append=TRUE)
write.table(df,"raport.txt",append=TRUE, col.names = FALSE,row.names=FALSE)
}
Outliers_detection<-function(df)
{
write("\n\nOUTLIERS\n","raport.txt",append=TRUE)
for(col in names(df))
{
if(is.numeric(df[[col]]))
{
#TESTY
pdf(file= "TEST.pdf" )
boxplot(df[[col]],
ylab = col)
dev.off()
#outliners<-append(outliners,(paste(col,boxplot.stats(df[[col]])$out,"\n")))
outliers<-boxplot.stats(df[[col]])$out
if(length(outliers)>0)
{
capture.output(cat(col,outliers,"\n"), file = "raport.txt",append=TRUE)
}
else
{
capture.output(cat(col,"no outliners","\n"), file = "raport.txt",append=TRUE)
}
}
}
}
Descriptive_statistics<-function(df)
{
Outliers_detection(df)
count_groups(df[1])
write("\n\nCHARACTERISTICS","raport.txt",append=TRUE)
splitted_groups<-split(df,df[1])
groupnames<-names(splitted_groups)
colnames<-names(df[,-1])
for(col in colnames)
{
for(group in groupnames)
{
if(is.numeric(splitted_groups[[group]][[col]]))
{
write(paste('\n\n', group, '\n', col), "raport.txt", append = TRUE)
s <- summary(splitted_groups[[group]][[col]])
capture.output(s, file = "raport.txt",append=TRUE)
}
}
}
}
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data<-Remove_NA(data_with_NA)
Descriptive_statistics(data)
#TESTY
pdf(file= "TEST.pdf" )
Outliers_detection<-function(df)
{
write("\n\nOUTLIERS\n","raport.txt",append=TRUE)
for(col in names(df))
{
if(is.numeric(df[[col]]))
{
#TESTY
pdf(file= "TEST.pdf" )
boxplot(df[[col]],
ylab = col)
dev.off()
#outliners<-append(outliners,(paste(col,boxplot.stats(df[[col]])$out,"\n")))
outliers<-boxplot.stats(df[[col]])$out
if(length(outliers)>0)
{
capture.output(cat(col,outliers,"\n"), file = "raport.txt",append=TRUE)
}
else
{
capture.output(cat(col,"no outliners","\n"), file = "raport.txt",append=TRUE)
}
}
}
}
Descriptive_statistics<-function(df)
{
Outliers_detection(df)
count_groups(df[1])
write("\n\nCHARACTERISTICS","raport.txt",append=TRUE)
splitted_groups<-split(df,df[1])
groupnames<-names(splitted_groups)
colnames<-names(df[,-1])
for(col in colnames)
{
for(group in groupnames)
{
if(is.numeric(splitted_groups[[group]][[col]]))
{
write(paste('\n\n', group, '\n', col), "raport.txt", append = TRUE)
s <- summary(splitted_groups[[group]][[col]])
capture.output(s, file = "raport.txt",append=TRUE)
}
}
}
}
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data<-Remove_NA(data_with_NA)
Descriptive_statistics(data)
Remove_NA <- function(df){
# for (col in names(df)) {
#   #If NA in numeric column than replace with a median
#
#   if(is.numeric(df[[col]]) & any(is.na(df[[col]]))) {
#     NA_rows <- which(is.na(df[[col]]))  # get rows with missing values
#     df[[col]][is.na(df[[col]])] <- median(df[[col]], na.rm = TRUE)
#     change_report <- c(change_report, paste("Missing data in column", col, "in rows:", paste(NA_rows, collapse = ", "),"replacing with a median",median(df[[col]])))
#   }
# }
change_report <- c()
df<-Replace_blank_with_NA(df)
splitted_groups<-split(df,df[1])
groupnames<-names(splitted_groups)
colnames<-names(df[,-1])
for(col in colnames)
{
for(group in groupnames)
{
if(is.numeric(splitted_groups[[group]][[col]]) & any(is.na(splitted_groups[[group]][[col]])))
{
NA_rows <- which(splitted_groups[[group]][[col]])  # get rows with missing values
splitted_groups[[group]][[col]][is.na(splitted_groups[[group]][[col]])] <- median(splitted_groups[[group]][[col]], na.rm = TRUE)
change_report <- c(change_report, paste("Missing data in column", col, "group",group, "in rows:", paste(NA_rows, collapse = ", "),"replacing with a median",median(splitted_groups[[group]][[col]])))
}
}
}
df <- do.call(rbind, splitted_groups)
#Now every NA in numeric columns are gone
#I delete every row with NA in non numeric column
TRUE_FALSE_vector<-complete.cases(df) #returns FALSE for rows with NA
Rows_to_delete<-which(TRUE_FALSE_vector==FALSE)
ready<-df[complete.cases(df),]
if (length(Rows_to_delete) > 0) {
deleted <- paste("Lack of data in non-numeric column I removed rows index:", paste(Rows_to_delete, collapse = ", "))
change_report<-append(change_report,deleted)
}
if(length(change_report) > 0) {
writeLines(change_report, "raport.txt")
}
return(ready)
}
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
Remove_NA <- function(df){
# for (col in names(df)) {
#   #If NA in numeric column than replace with a median
#
#   if(is.numeric(df[[col]]) & any(is.na(df[[col]]))) {
#     NA_rows <- which(is.na(df[[col]]))  # get rows with missing values
#     df[[col]][is.na(df[[col]])] <- median(df[[col]], na.rm = TRUE)
#     change_report <- c(change_report, paste("Missing data in column", col, "in rows:", paste(NA_rows, collapse = ", "),"replacing with a median",median(df[[col]])))
#   }
# }
change_report <- c()
df<-Replace_blank_with_NA(df)
splitted_groups<-split(df,df[1])
groupnames<-names(splitted_groups)
colnames<-names(df[,-1])
for(col in colnames)
{
for(group in groupnames)
{
if(is.numeric(splitted_groups[[group]][[col]]) & any(is.na(splitted_groups[[group]][[col]])))
{
NA_rows <- which(splitted_groups[[group]][[col]])  # get rows with missing values
splitted_groups[[group]][[col]][is.na(splitted_groups[[group]][[col]])] <- median(splitted_groups[[group]][[col]], na.rm = TRUE)
change_report <- c(change_report, paste("Missing data in column", col, "group",group, "in rows:", paste(NA_rows, collapse = ", "),"replacing with a median",median(splitted_groups[[group]][[col]])))
}
}
}
df <- do.call(rbind, splitted_groups)
#Now every NA in numeric columns are gone
#I delete every row with NA in non numeric column
TRUE_FALSE_vector<-complete.cases(df) #returns FALSE for rows with NA
Rows_to_delete<-which(TRUE_FALSE_vector==FALSE)
ready<-df[complete.cases(df),]
if (length(Rows_to_delete) > 0) {
deleted <- paste("Lack of data in non-numeric column I removed rows index:", paste(Rows_to_delete, collapse = ", "))
change_report<-append(change_report,deleted)
}
if(length(change_report) > 0) {
writeLines(change_report, "raport.txt")
}
return(ready)
}
setwd("C:/Users/weron/Documents/Studia/PP/4_semestr/SAD/Projekt")
library("Hmisc")
Replace_blank_with_NA<-function(x)
{
x<-replace(x,x=='',NA)
return(x)
}
Remove_NA <- function(df){
# for (col in names(df)) {
#   #If NA in numeric column than replace with a median
#
#   if(is.numeric(df[[col]]) & any(is.na(df[[col]]))) {
#     NA_rows <- which(is.na(df[[col]]))  # get rows with missing values
#     df[[col]][is.na(df[[col]])] <- median(df[[col]], na.rm = TRUE)
#     change_report <- c(change_report, paste("Missing data in column", col, "in rows:", paste(NA_rows, collapse = ", "),"replacing with a median",median(df[[col]])))
#   }
# }
change_report <- c()
df<-Replace_blank_with_NA(df)
splitted_groups<-split(df,df[1])
groupnames<-names(splitted_groups)
colnames<-names(df[,-1])
for(col in colnames)
{
for(group in groupnames)
{
if(is.numeric(splitted_groups[[group]][[col]]) & any(is.na(splitted_groups[[group]][[col]])))
{
NA_rows <- which(splitted_groups[[group]][[col]])  # get rows with missing values
splitted_groups[[group]][[col]][is.na(splitted_groups[[group]][[col]])] <- median(splitted_groups[[group]][[col]], na.rm = TRUE)
change_report <- c(change_report, paste("Missing data in column", col, "group",group, "in rows:", paste(NA_rows, collapse = ", "),"replacing with a median",median(splitted_groups[[group]][[col]])))
}
}
}
df <- do.call(rbind, splitted_groups)
#Now every NA in numeric columns are gone
#I delete every row with NA in non numeric column
TRUE_FALSE_vector<-complete.cases(df) #returns FALSE for rows with NA
Rows_to_delete<-which(TRUE_FALSE_vector==FALSE)
ready<-df[complete.cases(df),]
if (length(Rows_to_delete) > 0) {
deleted <- paste("Lack of data in non-numeric column I removed rows index:", paste(Rows_to_delete, collapse = ", "))
change_report<-append(change_report,deleted)
}
if(length(change_report) > 0) {
writeLines(change_report, "raport.txt")
}
return(ready)
}
count_groups <- function(column) {
unique_elements <- unique(column)
num_unique <- length(unique_elements)
counts <- table(column)
df <- data.frame(ID = names(counts), count = as.numeric(counts))
df
write("\nGROPUS AND THEIR SIZE\n","raport.txt",append=TRUE)
write.table(df,"raport.txt",append=TRUE, col.names = FALSE,row.names=FALSE)
}
Outliers_detection<-function(df)
{
write("\n\nOUTLIERS\n","raport.txt",append=TRUE)
pdf(file= "Outliers.pdf" )
for(col in names(df))
{
if(is.numeric(df[[col]]))
{
#TESTY
boxplot(df[[col]],
ylab = col)
outliers<-boxplot.stats(df[[col]])$out
mtext(paste("Outliers: ", paste(outliers, collapse = ", ")))
if(length(outliers)>0)
{
capture.output(cat(col,outliers,"\n"), file = "raport.txt",append=TRUE)
}
else
{
capture.output(cat(col,"no outliners","\n"), file = "raport.txt",append=TRUE)
}
}
}
dev.off()
}
Normal_distribution_detection<-function(df)
{
}
Descriptive_statistics<-function(df)
{
Outliers_detection(df)
count_groups(df[1])
write("\n\nCHARACTERISTICS","raport.txt",append=TRUE)
splitted_groups<-split(df,df[1])
groupnames<-names(splitted_groups)
colnames<-names(df[,-1])
for(col in colnames)
{
for(group in groupnames)
{
if(is.numeric(splitted_groups[[group]][[col]]))
{
write(paste('\n\n', group, '\n', col), "raport.txt", append = TRUE)
s <- summary(splitted_groups[[group]][[col]])
capture.output(s, file = "raport.txt",append=TRUE)
}
}
}
}
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data<-Remove_NA(data_with_NA)
Descriptive_statistics(data)
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data<-Remove_NA(data_with_NA)
data
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data_with_NA
data<-Remove_NA(data_with_NA)
data
Descriptive_statistics(data)
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data_with_NA
data<-Remove_NA(data_with_NA)
data
Descriptive_statistics(data)
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data_with_NA
data<-Remove_NA(data_with_NA)
data
data_with_NA<-read.csv2("Dane.csv",header=TRUE)
data_with_NA
data<-Remove_NA(data_with_NA)
data
debugSource("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
debugSource("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
debugSource("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
debugSource("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
debugSource("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
debugSource("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
debugSource("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
df
debugSource("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
df
df_old
nrow(df)
nrow(df_old)
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
source("~/Studia/PP/4_semestr/SAD/Projekt/Data_analysis.R")
